<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Custom imagery - Vespucci</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

<!--
                    <a class="navbar-brand" href="../..">Vespucci</a> -->
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">Vespucci</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../help/en/Introduction/">Introduction</a>
</li>
                                    
<li >
    <a href="../features/">Features</a>
</li>
                                    
<li >
    <a href="../../help/en/11.2.0 Release notes/">11.2.0 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/11.1.0 Release notes/">11.1.0 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/11.0.0 Release notes/">11.0.0 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/10.2.0 Release notes/">10.2.0 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/10.1.0 Release notes/">10.1.0 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/10.0.0 Release notes/">10.0.0 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/0.9.9 Release notes/">0.9.9 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/0.9.8 Release notes/">0.9.8 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/0.9.7 Release notes/">0.9.7 Release notes</a>
</li>
                                    
<li >
    <a href="../../help/en/0.9.6 Release notes/">0.9.6 Release notes</a>
</li>
                                    
<li >
    <a href="../old_release_notes/">Previous release notes</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Editing <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../help/en/Main map display/">Main map display</a>
</li>
                                    
<li >
    <a href="../../help/en/Creating new objects/">Creating new objects</a>
</li>
                                    
<li >
    <a href="../../help/en/Node selected/">Node selected</a>
</li>
                                    
<li >
    <a href="../../help/en/Way selected/">Way selected</a>
</li>
                                    
<li >
    <a href="../../help/en/Relation selected/">Relation selected</a>
</li>
                                    
<li >
    <a href="../../help/en/Property editor/">Property editor</a>
</li>
                                    
<li >
    <a href="../../help/en/Multiselect/">Multiselect</a>
</li>
                                    
<li >
    <a href="../../help/en/Conflict resolution/">Conflict resolution</a>
</li>
                                    
<li >
    <a href="../../help/en/Presets/">Presets</a>
</li>
                                    
<li >
    <a href="../../help/en/Aligning background imagery/">Aligning background imagery</a>
</li>
                                    
<li >
    <a href="../../help/en/Keyboard/">Keyboard and mouse</a>
</li>
                                    
<li >
    <a href="../../help/en/GPS sources/">GPS sources</a>
</li>
                                    
<li >
    <a href="../../help/en/Tag filter/">Tag based filter</a>
</li>
                                    
<li >
    <a href="../../help/en/Preset filter/">Preset based filter</a>
</li>
                                    
<li >
    <a href="../../help/en/Opening hours/">Opening hours</a>
</li>
                                    
<li >
    <a href="../../help/en/Preferences/">Preferences</a>
</li>
                                    
<li >
    <a href="../../help/en/Advanced preferences/">Advanced preferences</a>
</li>
                                    
<li >
    <a href="../../help/en/Voice commands/">Voice commands</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials and Posts <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../network_location/">"network" Location Provider Support</a>
</li>
                                    
<li class="active">
    <a href="./">Custom imagery</a>
</li>
                                    
<li >
    <a href="../name_suggestions/">Using name suggestions</a>
</li>
                                    
<li >
    <a href="../reporting_issues/">Reporting Vespucci issues</a>
</li>
                                    
<li >
    <a href="../tag_only/">Tag-only editing</a>
</li>
                                    
<li >
    <a href="../presets/">Vespucci presets</a>
</li>
                                    
<li >
    <a href="../vespucci_intents/">Controlling Vespucci from other apps</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="../screenshots/">Screenshots</a>
                            </li>
                            <li >
                                <a href="../faq/">FAQ</a>
                            </li>
                            <li >
                                <a href="../../help/en/Privacy/">Privacy</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
<!--- Remove Prev - Next
                            <li >
                                <a rel="next" href="../network_location/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../name_suggestions/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
i-->
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
<!--                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#custom-imagery">Custom imagery</a></li>
            <li><a href="#adding-a-custom-imagery-source">Adding a custom imagery source</a></li>
            <li><a href="#oam">OAM</a></li>
            <li><a href="#mbtiles">MBTiles</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="custom-imagery">Custom imagery</h1>
<p><em>by Simon Poole</em></p>
<p>For Vespucci 10.1 we've added four long requested features: a simple UI to add custom imagery sources, support for WMS servers that support the same projection as conventional
OpenStreetMap / google map tiles (EPSG:3857 and EPSG:900913), support for layers from <a href="https://openaerialmap.org/">OAM</a> and support for imagery layers in <a href="https://github.com/mapbox/mbtiles-spec">MBTiles</a> format.</p>
<h2 id="adding-a-custom-imagery-source">Adding a custom imagery source</h2>
<p><img alt="custom imagery form" src="../images/custom_imagery_empty.png" /> </p>
<p>To add a custom layer goto the <em>Advanced preferences</em> screen and select <em>Custom imagery</em>, press the <em>+</em> button to add a new layer. In the form you can set</p>
<ul>
<li>a <strong>Name</strong> this is what is displayed in the <em>Preferences</em> selection form. This field is <em>required</em>.</li>
<li>an <strong>URL</strong> the URL for the source with place holders in the same format as the <a href="https://github.com/osmlab/editor-layer-index">Editor Layer Index</a> (short ELI) that Vespucci and iD use as source for standard imagery. This field is <em>required</em>.</li>
<li>the<strong>Overlay</strong> flag, indicating that the layer is not a background, but partially transparent images for displaying over a background layer.</li>
<li><strong>Coverage</strong> left, bottom, right and top coordinates of a coverage bounding box in WGS84 coordinates, if the values are empty it is assumed that the layer covers the whole visible web-mercator area, that is -180°, -85°, 180°, 85°.</li>
<li><strong>Zoom</strong> <em>Min</em> and <em>Max</em> zoom levels, these indicates the minimum and maximum zoom levels available and are important for the app to determine over- and under-zoom correctly.</li>
</ul>
<h3 id="supported-placeholders">Supported placeholders</h3>
<p>Placeholders are replaced when the application retrieves imagery files from the source and are replaced by calculated values. There are some variants even between applications that in principle use the same system, which are noted for completeness sake below.</p>
<p>The placeholders have the general format of <strong>{</strong> <em>placeholder name</em> <strong>}</strong>.</p>
<p><strong>{zoom}</strong> the zoom level</p>
<p><strong>{x}</strong> the x tile number</p>
<p><strong>{y}</strong> the y tile number</p>
<p><strong>{-y}</strong> the y tile number for sources using TMS tile numbering. <em>ELI</em>, <em>iD</em>,  <em>Vespucci</em></p>
<p><strong>{ty}</strong> alternative for the y tile number for sources using TMS tile numbering. <em>iD</em>, <em>Vespucci</em></p>
<p><strong>{switch:a,b,c}</strong> rotating server selection (replace <em>a,b,c</em> by the actual sub-domains). <em>ELI</em>, <em>iD</em>, <em>Vespucci</em></p>
<p><strong>{quadkey}</strong> used for Bing. <em>Vespucci</em></p>
<p><strong>{u}</strong> used for Bing. <em>iD</em></p>
<p><strong>{proj}</strong> projection for WMS servers. <em>ELI</em>, <em>Vespucci (only in configuration files)</em></p>
<p><strong>{width}</strong> tile width for WMS servers. <em>ELI</em>, <em>Vespucci</em></p>
<p><strong>{height}</strong> tile height for WMS servers. <em>ELI</em>, <em>Vespucci</em></p>
<p><strong>{bbox}</strong> bounding box in <em>proj</em> coordinates for WMS servers. <em>ELI</em>, <em>Vespucci</em></p>
<p><strong>{subdomain}</strong> reserved, used internally by <em>Vespucci</em></p>
<ul>
<li>A valid normal (non-Bing) URL for a tile server must contain at least at least <strong>{zoom}</strong>, <strong>{x}</strong> and one of <strong>{y}</strong>, <strong>{-y}</strong> or <strong>{ty}</strong>.</li>
<li>A valid WMS server entry must contain at least <strong>{width}</strong>, <strong>{height}</strong> and <strong>{bbox}</strong> placeholders. Note: do not add a <strong>{proj}</strong> placeholder when adding such a layer in the "Custom imagery" form in Vespucci (it is supported in the configuration files).</li>
</ul>
<h3 id="examples">Examples</h3>
<p>Tile server example:</p>
<pre><code>http://tiles.poole.ch/AGIS/OF2011/{zoom}/{x}/{y}.png
</code></pre>
<p>WMS server example:</p>
<pre><code>https://geodienste.sachsen.de/wms_geosn_dop-rgb/guest?FORMAT=image/jpeg&amp;VERSION=1.1.1&amp;SERVICE=WMS&amp;REQUEST=GetMap&amp;LAYERS=sn_dop_020&amp;STYLES=&amp;SRS=EPSG:3857&amp;WIDTH={width}&amp;HEIGHT={height}&amp;BBOX={bbox}
</code></pre>
<h2 id="oam">OAM</h2>
<p>You can query the OAM catalog by going to <em>Tools</em> and selecting <em>Add imagery from OAM</em>, this will query the OAM servers for layers in the current view:</p>
<p><img alt="oam imagery form" src="../images/custom_imagery_oam.png" /> </p>
<p>Unluckily it doesn't seem to be customary to give the imagery meaningful names on OAM, but as the use case is likely mostly use of layers that you have created yourself, it is likely bearable. After you've selected an entry you will again be shown the custom imagery dialog. Note: we try to determine the maximum zoom level from the nominal resolution of imagery as stored in OAM, however we've seen a couple of wacky values for this (sub-milimeter) and you should check that the value is roughly correct before saving. </p>
<h2 id="mbtiles">MBTiles</h2>
<p>To add a MBTiles layer, down/upload the MBTiles format file to your device, then go to the <em>Custom imagery</em> form as described above. Tap the <em>SD card</em> icon, navigate to the folder where you saved the file and select it. The form should now be filled out with all necessary values.</p>
<p>Notes:</p>
<ul>
<li>The MBTiles format does not contain meta-data for min and max zoom levels, the query that determines the values from the actual file contents may take a long time to run if the file is large.</li>
<li>Vespucci currently supports png and jpg contents.</li>
<li>You can adjust all values in the form before saving if necessary with exception of the URL field that contains the path to the file.</li>
</ul>
<p><img alt="MBTiles configuration" src="../images/custom_imagery_mbtiles.png" /></p>
<p><strong>Happy mapping!</strong> </p></div> -->
                
                    <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#custom-imagery">Custom imagery</a></li>
            <li><a href="#adding-a-custom-imagery-source">Adding a custom imagery source</a></li>
            <li><a href="#oam">OAM</a></li>
            <li><a href="#mbtiles">MBTiles</a></li>
    </ul>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="custom-imagery">Custom imagery</h1>
<p><em>by Simon Poole</em></p>
<p>For Vespucci 10.1 we've added four long requested features: a simple UI to add custom imagery sources, support for WMS servers that support the same projection as conventional
OpenStreetMap / google map tiles (EPSG:3857 and EPSG:900913), support for layers from <a href="https://openaerialmap.org/">OAM</a> and support for imagery layers in <a href="https://github.com/mapbox/mbtiles-spec">MBTiles</a> format.</p>
<h2 id="adding-a-custom-imagery-source">Adding a custom imagery source</h2>
<p><img alt="custom imagery form" src="../images/custom_imagery_empty.png" /> </p>
<p>To add a custom layer goto the <em>Advanced preferences</em> screen and select <em>Custom imagery</em>, press the <em>+</em> button to add a new layer. In the form you can set</p>
<ul>
<li>a <strong>Name</strong> this is what is displayed in the <em>Preferences</em> selection form. This field is <em>required</em>.</li>
<li>an <strong>URL</strong> the URL for the source with place holders in the same format as the <a href="https://github.com/osmlab/editor-layer-index">Editor Layer Index</a> (short ELI) that Vespucci and iD use as source for standard imagery. This field is <em>required</em>.</li>
<li>the<strong>Overlay</strong> flag, indicating that the layer is not a background, but partially transparent images for displaying over a background layer.</li>
<li><strong>Coverage</strong> left, bottom, right and top coordinates of a coverage bounding box in WGS84 coordinates, if the values are empty it is assumed that the layer covers the whole visible web-mercator area, that is -180°, -85°, 180°, 85°.</li>
<li><strong>Zoom</strong> <em>Min</em> and <em>Max</em> zoom levels, these indicates the minimum and maximum zoom levels available and are important for the app to determine over- and under-zoom correctly.</li>
</ul>
<h3 id="supported-placeholders">Supported placeholders</h3>
<p>Placeholders are replaced when the application retrieves imagery files from the source and are replaced by calculated values. There are some variants even between applications that in principle use the same system, which are noted for completeness sake below.</p>
<p>The placeholders have the general format of <strong>{</strong> <em>placeholder name</em> <strong>}</strong>.</p>
<p><strong>{zoom}</strong> the zoom level</p>
<p><strong>{x}</strong> the x tile number</p>
<p><strong>{y}</strong> the y tile number</p>
<p><strong>{-y}</strong> the y tile number for sources using TMS tile numbering. <em>ELI</em>, <em>iD</em>,  <em>Vespucci</em></p>
<p><strong>{ty}</strong> alternative for the y tile number for sources using TMS tile numbering. <em>iD</em>, <em>Vespucci</em></p>
<p><strong>{switch:a,b,c}</strong> rotating server selection (replace <em>a,b,c</em> by the actual sub-domains). <em>ELI</em>, <em>iD</em>, <em>Vespucci</em></p>
<p><strong>{quadkey}</strong> used for Bing. <em>Vespucci</em></p>
<p><strong>{u}</strong> used for Bing. <em>iD</em></p>
<p><strong>{proj}</strong> projection for WMS servers. <em>ELI</em>, <em>Vespucci (only in configuration files)</em></p>
<p><strong>{width}</strong> tile width for WMS servers. <em>ELI</em>, <em>Vespucci</em></p>
<p><strong>{height}</strong> tile height for WMS servers. <em>ELI</em>, <em>Vespucci</em></p>
<p><strong>{bbox}</strong> bounding box in <em>proj</em> coordinates for WMS servers. <em>ELI</em>, <em>Vespucci</em></p>
<p><strong>{subdomain}</strong> reserved, used internally by <em>Vespucci</em></p>
<ul>
<li>A valid normal (non-Bing) URL for a tile server must contain at least at least <strong>{zoom}</strong>, <strong>{x}</strong> and one of <strong>{y}</strong>, <strong>{-y}</strong> or <strong>{ty}</strong>.</li>
<li>A valid WMS server entry must contain at least <strong>{width}</strong>, <strong>{height}</strong> and <strong>{bbox}</strong> placeholders. Note: do not add a <strong>{proj}</strong> placeholder when adding such a layer in the "Custom imagery" form in Vespucci (it is supported in the configuration files).</li>
</ul>
<h3 id="examples">Examples</h3>
<p>Tile server example:</p>
<pre><code>http://tiles.poole.ch/AGIS/OF2011/{zoom}/{x}/{y}.png
</code></pre>
<p>WMS server example:</p>
<pre><code>https://geodienste.sachsen.de/wms_geosn_dop-rgb/guest?FORMAT=image/jpeg&amp;VERSION=1.1.1&amp;SERVICE=WMS&amp;REQUEST=GetMap&amp;LAYERS=sn_dop_020&amp;STYLES=&amp;SRS=EPSG:3857&amp;WIDTH={width}&amp;HEIGHT={height}&amp;BBOX={bbox}
</code></pre>
<h2 id="oam">OAM</h2>
<p>You can query the OAM catalog by going to <em>Tools</em> and selecting <em>Add imagery from OAM</em>, this will query the OAM servers for layers in the current view:</p>
<p><img alt="oam imagery form" src="../images/custom_imagery_oam.png" /> </p>
<p>Unluckily it doesn't seem to be customary to give the imagery meaningful names on OAM, but as the use case is likely mostly use of layers that you have created yourself, it is likely bearable. After you've selected an entry you will again be shown the custom imagery dialog. Note: we try to determine the maximum zoom level from the nominal resolution of imagery as stored in OAM, however we've seen a couple of wacky values for this (sub-milimeter) and you should check that the value is roughly correct before saving. </p>
<h2 id="mbtiles">MBTiles</h2>
<p>To add a MBTiles layer, down/upload the MBTiles format file to your device, then go to the <em>Custom imagery</em> form as described above. Tap the <em>SD card</em> icon, navigate to the folder where you saved the file and select it. The form should now be filled out with all necessary values.</p>
<p>Notes:</p>
<ul>
<li>The MBTiles format does not contain meta-data for min and max zoom levels, the query that determines the values from the actual file contents may take a long time to run if the file is large.</li>
<li>Vespucci currently supports png and jpg contents.</li>
<li>You can adjust all values in the form before saving if necessary with exception of the URL field that contains the path to the file.</li>
</ul>
<p><img alt="MBTiles configuration" src="../images/custom_imagery_mbtiles.png" /></p>
<p><strong>Happy mapping!</strong> </p></div>
                
        </div>

        <footer class="col-md-12">
            <hr>
<!--            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p> -->
                <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> for Vespucci 11.2.0 </p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
