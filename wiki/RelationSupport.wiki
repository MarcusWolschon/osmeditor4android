#summary Relation Support

= Introduction =

Branch 0.9 has minimal relation support with the goal of keeping existing relation memberships and relations intact and consistent after elements have been edited. It currently supports explicit editing of relation tags, deletion of relations and adding turn restrictions.

A beta build APK is available in the download section.

= Features =

 * relation membership display on tag editing form
 * spliting of ways retains relation membership in both resulting segments with the exception of restrictions where it tries to assign restriction membership to the correct part.
 * relations can be selected for tag editing and deletion by clicking on a member of the relation and selecting the relation in the popup.
 * turn restrictions can be added, in EasyEdit mode select a way, then from the menu "Add restriction" then the "via" and "to" elements. 
 * rendering of otherwise untagged ways that are part of a multipolygon is based on the mp tags.

= Implementation =

The implementation is in line with the exsiting way and node implementation, a slight depature is that the elements now contain a list of parent relations. While this potentially leads to inconsistencies, it makes it unnecessary to scan all downloaded relations for membership (such an implementation would however be possible).

= Other Changes =

 * some changes to the rendering were made. landuse and tracks now have seperate rendering, house color was changed. The rendering is now user selectable the old "everything black" style is available as "Default", this one as "Color". Further styles can be added, but please be aware that the current implementation is not likely to be long lived.
 * loading and saving the data state failed on 2.3 devices and emulators due to stack overflows, moving these operation to separate threads seems to have fixed it, besides being slightly hackish, the allocated stack size probably needs some tuning.
 * a long press on a preset in the tag editor will remove it from the preset list. 
 * added the trivial changes for basic Samsung multi window support
 * merging of ways now tries to preserve existing way ids and uses conventional tag merging logic
 * reversing a way, either explictly in EasyEdit mode or implicitly by merging ways with different directions, will now reverse direction dependent tags. If a oneway tag is present, the explicit reversing will not change the value of oneway, assuming that this was the point of reversing in the first place.
 * reversing a "non-reverable" way will display a warning.
 * replaced OSM bugs support with support for the new Notes API (note the XML verion of the Notes API still has some issues which is the reason for the "unknown action" string in the display)
 * quick way of re-enabling GPS following: The GPS marker will turn to white (default for now) when following and back to the standard blue when following has been turned off. Clicking/touching the marker will turn following back on. Initially the following still has to be turned on via the menu.

= Open Issues =

 * more testing needs to be done
 * documentation

= Further Work =

 * more testing
 * allow addition/deletion of relation membership
 * automatic used imagery layer changeset tag as P2 and iD produce
 * GUI clean up (reduce the number of modes for example the seperate split and append modes would seem to be unnecessary)